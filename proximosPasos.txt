# ğŸ›ï¸ Reserva Express (Walkâ€‘ins)
La funcionalidad **Reserva Express** permite registrar huÃ©spedes que llegan sin reserva previa y se alojan por una noche.  
Este tipo de estadÃ­a es comÃºn en mostrador y debe quedar registrada para que el mÃ³dulo de consumos pueda:

- asociar consumos a la habitaciÃ³n,
- mostrar al huÃ©sped en el dashboard,
- permitir checkout al dÃ­a siguiente,
- mantener un historial real de ocupaciÃ³n.

Esta implementaciÃ³n convierte al sistema en un PMS mÃ¡s completo, permitiendo manejar tanto reservas anticipadas como huÃ©spedes espontÃ¡neos.

---

## âœ… IMPLEMENTACIONES RECIENTES (17/01/2026)

### 1. ReorganizaciÃ³n de Botones en Dashboard
- âœ… Movido botÃ³n "Consulta de Consumos" desde posiciÃ³n flotante al header
- âœ… Ahora estÃ¡ junto con los botones de gestiÃ³n principales
- âœ… Mejora la experiencia de usuario y accesibilidad

### 2. Checkout Anticipado
- âœ… Implementado sistema de checkout para retiros anticipados
- âœ… Banner amarillo en ficha de habitaciÃ³n para procesar retiros antes de fecha programada
- âœ… ConfirmaciÃ³n adicional para evitar checkouts accidentales
- âœ… Casos de uso: emergencias personales, problemas urgentes, cambios de plan
- âœ… Template de checkout diferencia entre checkout normal y anticipado
- âœ… DocumentaciÃ³n actualizada en README.md

---

## ğŸ¯ Contexto del Proyecto

### Flujo Operativo en Temporada Alta
- Reservas masivas procesadas por 4-5 dÃ­as continuos
- Hotel completo al 90% con contingentes
- Habitaciones libres gestionadas como Walk-ins (1-2 dÃ­as)
- Todos ingresan y se van el mismo dÃ­a (contingentes)
- Retiros anticipados por urgencias personales o problemas

### DecisiÃ³n de Arquitectura
- **Repositorio actual (recepcion2026-consumos)**: Sistema operativo diario (Dashboard + Consumos + Reservas Express)
- **Repositorio anterior (recepcion2026-reservas)**: Procesamiento batch obsoleto (Excel + openpyxl)
- **Estrategia**: Mantener separados, priorizar dashboard actual que maneja tanto reservas como consumos

---

## ğŸ¯ Objetivo
Crear una reserva mÃ­nima con los datos esenciales:

- HabitaciÃ³n  
- Nombre del huÃ©sped (opcional)  
- Cantidad de pasajeros  
- Fecha de entrada: **hoy**  
- Fecha de salida: **maÃ±ana**  
- Origen: `"walk-in"`

La reserva se guarda en `data/reservas.csv` para que otros mÃ³dulos puedan consumirla.

---

## ğŸ§© Flujo de uso
1. Un huÃ©sped llega sin reserva.  
2. El recepcionista asigna una habitaciÃ³n disponible.  
3. Se ejecuta la funciÃ³n `crear_reserva_express`.  
4. La reserva queda registrada automÃ¡ticamente.  
5. El mÃ³dulo de consumos puede cargar consumos a esa habitaciÃ³n sin errores.  

---

## ğŸ CÃ³digo Python sugerido

```python
from datetime import date, timedelta
import csv
import os

def crear_reserva_express(habitacion, nombre="HuÃ©sped sin reserva", pax=1):
    """
    Crea una reserva mÃ­nima para huÃ©spedes que llegan sin reserva previa (walk-ins).
    La reserva se registra para la fecha actual y una noche de estadÃ­a.
    """

    hoy = date.today()
    manana = hoy + timedelta(days=1)

    nueva_reserva = {
        "habitacion": habitacion,
        "nombre": nombre,
        "pax": pax,
        "checkin": hoy.isoformat(),
        "checkout": manana.isoformat(),
        "origen": "walk-in"
    }

    # Asegurar que el archivo existe y tiene encabezados
    ruta = "data/reservas.csv"
    archivo_existe = os.path.exists(ruta)

    with open(ruta, "a", newline="", encoding="utf-8") as f:
        writer = csv.DictWriter(f, fieldnames=nueva_reserva.keys())

        if not archivo_existe:
            writer.writeheader()

        writer.writerow(nueva_reserva)

    return nueva_reserva
---
ğŸ”— IntegraciÃ³n con otros mÃ³dulos
Con recepcion2026-consumos
Cuando se intenta cargar un consumo a una habitaciÃ³n sin estadÃ­a activa:

El sistema puede detectar que no existe reserva.

Preguntar si se desea crear una Reserva Express.

Llamar a crear_reserva_express.

Continuar con la carga del consumo sin interrupciones.

ğŸš€ PrÃ³ximos pasos
Integrar esta funciÃ³n en un mÃ³dulo core/reserva_express.py.

Crear un validador de disponibilidad simple.

Preparar la migraciÃ³n a SQLite para manejar walkâ€‘ins como registros reales de estadÃ­a.

Conectar reservas y consumos mediante un ID Ãºnico de estadÃ­a.